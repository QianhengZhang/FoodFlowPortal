<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>Interactive Pydeck Map</title>
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v1.13.0/mapbox-gl.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <script src='https://cdn.jsdelivr.net/npm/@deck.gl/jupyter-widget@~9.0.*/dist/index.js'></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
      }

      #deck-container {
        width: 100vw;
        height: 100vh;
      }

      #deck-container canvas {
        z-index: 1;
        background: none;
      }
    </style>
  </head>
  <body>
    <div id="deck-container"></div>
  </body>
  <script>
    const container = document.getElementById('deck-container');

    const jsonInput = {
      "initialViewState": {
        "bearing": 0,
        "latitude": 37.7749295,
        "longitude": -122.4194155,
        "pitch": 45,
        "zoom": 11
      },
      "layers": [
        {
          "@@type": "TripsLayer",
          "currentTime": 500,
          "data": [
            {
              "coordinates": [
                [-122.39079879999997, 37.7664413],
                [-122.3908298, 37.7667706],
                [-122.39271759999997, 37.7667484],
                [-122.3951341, 37.7665964],
                [-122.409425, 37.7779834]
              ],
              "timestamps": [0, 9, 54, 92, 345]
            }
          ],
          "getColor": [253, 128, 93],
          "getPath": "@@=coordinates",
          "getTimestamps": "@@=timestamps",
          "id": "5a116742-5ec0-466a-b22b-a360017340d7",
          "opacity": 0.8,
          "rounded": true,
          "trailLength": 600,
          "widthMinPixels": 5
        }
      ],
      "mapProvider": "carto",
      "mapStyle": "https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",
      "views": [
        {
          "@@type": "MapView",
          "controller": true
        }
      ]
    };

    const tooltip = true;
    const customLibraries = null;
    const configuration = null;

    const deckInstance = createDeck({
      container,
      jsonInput,
      tooltip,
      customLibraries,
      configuration
    });

    // Add click event listener
    container.addEventListener('click', (event) => {
      const lat = event.clientY;
      const lon = event.clientX;
      alert('Clicked at: ' + lat + ', ' + lon);
      // Add logic to display inflows/outflows or other relevant data
    });
  </script>
</html>
